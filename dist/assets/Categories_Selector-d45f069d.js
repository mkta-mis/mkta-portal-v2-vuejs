import{_ as S,r as i,o as c,e as v,w as s,b as l,g,f as r,t as C,i as j,j as M,v as I,a as u,c as f,F as V,d as T,n as L}from"./index-93b9d787.js";const N={emits:["change","close"],props:{isDialog:{default:!1,type:Boolean},pageTitle:{default:"File Upload",type:String},isMultiple:{default:!1,type:Boolean},isSelectMultiple:{default:!1,type:Boolean},Configuration:{default:{accepts:"image/png, image/jpeg, image/bmp",label:"Upload Image",placeholder:"Pick an Image",icon:"mdi-file-image",searchType:"image"},type:Object}},data(){return{isSaving:!0,maxCount:0,curCount:0,showImage:!1,showDialog:!1,selectedOptions:1,files:{selectedContent:[],selectedKey:[],contents:[],search:""},data:[],paginate:[],curPage:1,chunkSize:5}},components:{},setup(){},created(){this.searchFiles()},mounted(){},methods:{set_Paginate(t){this.paginate=[];for(let e=0;e<t.length;e+=this.chunkSize)this.paginate.push(t.slice(e,e+this.chunkSize));this.curPage=1},fileSelection(t){if(this.isSelectMultiple){let e=this.files.selectedKey.indexOf(t.id);e!=-1?(this.files.selectedContent.splice(e,1),this.files.selectedKey.splice(e,1)):(this.files.selectedContent.push(t),this.files.selectedKey.push(t.id))}else this.files.selectedContent=t,this.files.selectedKey=[],this.files.selectedKey.push(t.id)},searchFiles(){this.$axios.post(this.$serverURL+"api/files/search",{title:this.files.search,type:this.Configuration.searchType}).then(t=>{t.data.code==200&&(this.files.contents=t.data.results,this.set_Paginate(this.files.contents))}).catch(t=>{})},uploadFile(t){let e=new FormData;e.append("tokenString",localStorage.getItem("userToken")),e.append("image",t),this.$axios.post(this.$serverURL+"api/files/upload",e,{headers:{"Content-Type":"multipart/form-data"}}).then(n=>{this.curCount++,this.curCount>=this.maxCount&&this.searchFiles()}).catch(n=>{})},singleUpload(t){this.maxCount=1,this.curCount=0,this.uploadFile(t.target.files[0])},multipleUpload(t){this.maxCount=t.target.files.length,this.curCount=0,t.target.files.forEach((e,n)=>{this.uploadFile(t.target.files[n])})}}},R={key:0,class:"text-left"},E=u("th",{class:"text-left"}," Filename ",-1),A=u("th",{class:"text-left"}," Type ",-1),q=["onClick"],G={key:0};function H(t,e,n,U,a,d){const _=i("v-spacer"),h=i("v-btn"),p=i("v-card-actions"),b=i("v-card-title"),x=i("v-tab"),K=i("v-tabs"),O=i("v-file-input"),m=i("v-card-text"),y=i("v-card"),k=i("v-window-item"),F=i("v-text-field"),w=i("v-icon"),P=i("v-img"),D=i("v-table"),B=i("v-pagination"),z=i("v-window");return c(),v(y,{class:"bg-white h-100"},{default:s(()=>[n.isDialog?(c(),v(p,{key:0,"fixed-header":""},{default:s(()=>[l(_),l(h,{fab:"",icon:"mdi-close",class:"bg-danger text-white",onClick:e[0]||(e[0]=o=>t.$emit("close"))})]),_:1})):g("",!0),l(b,{"fixed-header":""},{default:s(()=>[r(C(n.pageTitle),1)]),_:1}),l(m,null,{default:s(()=>[l(K,{modelValue:a.selectedOptions,"onUpdate:modelValue":e[1]||(e[1]=o=>a.selectedOptions=o),class:"mb-3"},{default:s(()=>[l(x,{value:1},{default:s(()=>[r("Via Upload")]),_:1}),l(x,{value:2},{default:s(()=>[r("Via File Vault")]),_:1})]),_:1},8,["modelValue"]),l(z,{modelValue:a.selectedOptions,"onUpdate:modelValue":e[7]||(e[7]=o=>a.selectedOptions=o)},{default:s(()=>[l(k,{value:1},{default:s(()=>[l(y,null,{default:s(()=>[l(m,null,{default:s(()=>[l(O,{multiple:n.isMultiple,accept:n.Configuration.accepts,label:n.Configuration.label,placeholder:n.Configuration.placeholder,"prepend-icon":n.Configuration.icon,disabled:a.curCount<a.maxCount,ref:"uploadFile",loading:a.curCount<a.maxCount,"single-line":"","show-size":"",onChange:e[2]||(e[2]=o=>n.isMultiple?d.multipleUpload(o):d.singleUpload(o))},null,8,["multiple","accept","label","placeholder","prepend-icon","disabled","loading"])]),_:1})]),_:1})]),_:1}),l(k,{value:2},{default:s(()=>[l(y,null,{default:s(()=>[l(m,null,{default:s(()=>[l(F,{"prepend-icon":"mdi-magnify","persistent-hint":"",hint:"Search",modelValue:this.files.search,"onUpdate:modelValue":e[3]||(e[3]=o=>this.files.search=o),onKeyup:j(d.searchFiles,["enter"])},null,8,["modelValue","onKeyup"]),l(h,{class:"my-1",size:"small",onClick:e[4]||(e[4]=()=>{a.files.search="",d.searchFiles()})},{default:s(()=>[l(w,{class:"me-2"},{default:s(()=>[r("mdi-refresh")]),_:1}),r("Refresh")]),_:1})]),_:1}),n.isDialog?(c(),v(p,{key:0},{default:s(()=>[l(_),M(l(h,{onClick:e[5]||(e[5]=()=>{t.$emit("change",a.files.selectedContent)}),class:"bg-success"},{default:s(()=>[l(w,{class:"me-1"},{default:s(()=>[r("mdi-content-save")]),_:1}),r("Proceed")]),_:1},512),[[I,a.files.selectedContent!=null]])]),_:1})):g("",!0),l(m,null,{default:s(()=>[l(D,{density:"compact",class:"border p-1","fixed-header":""},{default:s(()=>[u("thead",null,[u("tr",null,[this.Configuration.searchType=="image"?(c(),f("th",R)):g("",!0),E,A])]),u("tbody",null,[(c(!0),f(V,null,T(a.paginate[a.curPage-1],o=>(c(),f("tr",{onClick:X=>d.fileSelection(o),class:L(this.files.selectedKey.indexOf(o.id)!=-1?"bg-secondary":"")},[this.Configuration.searchType=="image"?(c(),f("td",G,[l(P,{src:t.$serverURL+"resources/"+o.filename},null,8,["src"])])):g("",!0),u("td",null,C(o.title),1),u("td",null,C(o.type),1)],10,q))),256))])]),_:1})]),_:1}),l(m,null,{default:s(()=>[l(B,{modelValue:a.curPage,"onUpdate:modelValue":e[6]||(e[6]=o=>a.curPage=o),length:a.paginate.length,"total-visible":7},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}const Z=S(N,[["render",H]]),J={emits:["selected"],props:{tree:{type:Object,default:[]},main:{type:Object}},data(){return{isSelected:!1,finalTree:[]}},components:{},setup(){},watch:{tree(){this.finalTree=this.tree}},created(){},mounted(){},methods:{child_selected(t){this.finalTree=[],Array.isArray(t)?t.forEach(e=>{this.finalTree.push(e)}):this.finalTree.push(t),this.finalTree.push(this.main.parent_id),this.$emit("selected",this.finalTree)}}},Q={class:"ms-3 border-start"};function W(t,e,n,U,a,d){const _=i("v-btn"),h=i("Categories_Selector",!0);return c(),f("div",Q,[l(_,{onClick:e[0]||(e[0]=p=>d.child_selected(n.main.id)),flat:"","prepend-icon":this.tree.indexOf(this.main.id)!=-1?"mdi-checkbox-marked":"mdi-checkbox-blank-outline"},{default:s(()=>[r(C(n.main.name),1)]),_:1},8,["prepend-icon"]),u("div",null,[(c(!0),f(V,null,T(n.main.full_data,(p,b)=>(c(),v(h,{tree:this.tree,main:p,onSelected:d.child_selected},null,8,["tree","main","onSelected"]))),256))])])}const $=S(J,[["render",W]]);export{$ as C,Z as F};
